version: '{build}'
init:
  - 'git config --global core.autocrlf true'
branches:
  only:
    - antora-migration
skip_commits:
  files:
    - LICENSE
environment:
  nodejs_version: 18
platform:
  - x64
install:
  - ps: 'Install-Product node $env:nodejs_version $env:platform'
  - 'node --version && npm --version'
  - 'npx antora -v'
build_script:
  - 'if exist build rd /Q /S build'
  - 'npx antora antora-playbook.yml'
test: off
artifacts:
  - path: 'build'
deploy:
  provider: FTP
  protocol: sftp
  host: ssh.strato.de
  username: kimminich.de
  password:
    secure: Vu/o5fi8cCRsc9VmD4B/Xg==
  folder: pwning-juice-shop/antora
  application: build.zip
  on:
    branch: antora-migration
notifications:
  -
    provider: Webhook
    url:
      secure: c4xwvfA2YpTyASkpasFt2oTuz51teT2qAgq9gU45flir+cdJeT1/utEXowV/TsvmjrsUPRawd/ZNch9ZnAMZCg==
    method: GET
  -
    provider: Slack
    incoming_webhook:
      secure: KzO8e88B0LKqAI0BQM6lNhCIn9rxAava3AcdVJDyTw420OLIAlK+qzzbLXaR0jSH9zIJz9zu0iGS1iaqu9Co+6owYUrHJlBGrUZ/lZNCsDo=
    on_build_success: false
    on_build_failure: false
    on_build_status_changed: true
